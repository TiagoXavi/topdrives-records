import{n as o,b as r,L as i}from"./components-DpxtCXPw.js";const n={name:"MainResetPassword",components:{Logo:i,BaseText:r},props:{wrap:{type:Boolean,default:!1},export:{type:Boolean,default:!1}},data(){return{email:null,password:null,input_error:!1,finished:!1,loading:!1}},watch:{},beforeMount(){},mounted(){},computed:{},methods:{validate(){this.email=this.email.trim();var a=new RegExp(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/);if(!a.test(this.email)){this.putError("Invalid email");return}if(!this.password||this.password.length===0){this.putError("Type password");return}this.send()},putError(a){this.$store.commit("DEFINE_SNACK",{error:!0,text:a}),this.input_error=!0,setTimeout(()=>{this.input_error=!1},1500)},send(){if(this.export){this.$emit("export",{email:this.email.toLowerCase(),password:this.password});return}let a=this;this.loading=!0;let t=Vue.preUrl+"/auth",e=window.localStorage.getItem("auth");e&&(t=t+`?auth=${e}`),axios.post(t,{email:this.email.toLowerCase(),password:this.password}).then(s=>{if(s.data==="OK")this.$store.commit("DEFINE_SNACK",{active:!0,correct:!0,text:this.$t("m_loginSuccess")}),this.$store.commit("AUTH",{}),a.wrap?a.$emit("success"):setTimeout(()=>{a.$router.push({name:"Records"})},200);else throw new Error}).catch(s=>{console.log(s),this.$store.commit("DEFINE_SNACK",{active:!0,error:!0,text:s,type:"error"})}).then(()=>{this.loading=!1})}}};var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"TTT_Layout",class:{MainLoginWrap:t.wrap}},[e("div",{staticClass:"TTT_Box"},[e("div",{staticClass:"TTT_Mid"},[e("BaseText",{staticClass:"Space_Bottom",attrs:{type:"normal",custom_inputMode:"email",label:t.$t("m_email"),placeholder:""},model:{value:t.email,callback:function(s){t.email=s},expression:"email"}}),e("BaseText",{staticClass:"Space_Bottom",attrs:{intype:"password",type:"normal",label:t.$t("m_password"),placeholder:""},model:{value:t.password,callback:function(s){t.password=s},expression:"password"}}),e("div",{staticClass:"TTT_Forgot TTT_ForgotBetween"},[e("button",{staticClass:"D_Button D_Link",staticStyle:{"font-size":"13px","--height":"25px"},on:{click:function(s){t.$emit("close"),t.$router.push({name:"Register"})}}},[t._v(t._s(t.$t("m_register"))+"?")]),e("button",{staticClass:"D_Button D_Link",staticStyle:{"font-size":"13px","--height":"25px"},on:{click:function(s){t.$emit("close"),t.$router.push({name:"AskNewPassword"})}}},[t._v(t._s(t.$t("m_forgot"))+"?")])])],1),e("div",{staticClass:"TTT_Bottom"},[e("button",{staticClass:"D_Button D_ButtonDark TTT_Button",class:{D_Button_Loading:t.loading,D_Button_Error:t.input_error},attrs:{disabled:t.loading||t.input_error},on:{click:function(s){return t.validate()}}},[t._v(t._s(t.$t("m_login")))]),t.wrap?t._e():e("router-link",{staticClass:"D_Link Space_Top",staticStyle:{"font-size":"14px"},attrs:{to:{name:"Records"}}},[t._v(t._s(t.$t("m_cancel")))])],1)])])},c=[],u=o(n,l,c,!1,null,null);const m=u.exports;export{m as default};
