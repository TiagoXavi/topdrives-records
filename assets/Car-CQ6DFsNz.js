import{R as y}from"./Row-DOgu6NRG.js";import{B as v}from"./BaseCard-CTEQO1B5.js";import{n as C}from"./index-BR-PFC2m.js";var u=0,c=0,m=0,f=0,o=null,a=0,g=0,s=0,l=0,p=!1;const _={name:"Car",components:{Row:y,BaseCard:v},props:{car:{type:Object,default(){return{}}},trackList:{type:Array,default(){return[]}},highlights:{type:Object,default(){return{}}},countPerTrack:{type:Object,default(){return{}}},hoverIndex:{type:Number,default:-1},maxCarNumber:{required:!0},user:{required:!1},points:{required:!1},index:{required:!0},lastIndex:{type:Number,default:-1},loggedin:{type:Boolean,default:!1},showPoints:{type:Boolean,default:!1},isReferencePoints:{type:Boolean,default:!1},downloadLoading:{type:Boolean,default:!1},voteLoading:{type:Boolean,default:!1},needSave:{type:Boolean,default:!1},invertedView:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},data(){return{}},watch:{},beforeMount(){},mounted(){},computed:{},methods:{dragMouseDown(t){o=document.querySelector("#Car_Layout"+this.index),t=t||window.event,t.preventDefault(),u=t.clientX,c=t.clientY,document.onmouseup=this.closeDragElement,document.onmousemove=this.elementDrag},elementDrag(t){if(m=t.clientX-u,f=t.clientY-c,p=!p,p)return;o.style.setProperty("--drag-left",m),o.style.setProperty("--drag-top",f),o.classList.add("Car_Dragging"),o.parentElement.classList.add("Car_DraggingParent"),s=Number(getComputedStyle(document.body).getPropertyValue("--cell-width").trim().slice(0,-2)),this.compact&&(s=Number(getComputedStyle(document.querySelector(".Main_Compact")).getPropertyValue("--cell-width").trim().slice(0,-2))),this.invertedView&&(l=Number(getComputedStyle(document.querySelector(".Main_2")).getPropertyValue("--cell-height").trim().slice(0,-2))),a=Math.round(m/s),this.invertedView&&(a=Math.round(f/l));let e=Math.abs(a),n=a>0?"Car_PushLeft":"Car_PushRight",r,i=document.querySelectorAll(".Car_Layout").length-1;this.index+a>i-1&&(console.log("incor",a,"correct",i-this.index-1),a=i-this.index-1),this.index+a<0&&(a=this.index*-1),a!==g&&(g=a,document.querySelectorAll(".Car_Layout").forEach(d=>{d.classList.remove("Car_PushLeft"),d.classList.remove("Car_PushRight")}),Array.from(Array(e)).map((d,h)=>{a>0?r=document.querySelector("#Car_Layout"+(a+this.index-h)):r=document.querySelector("#Car_Layout"+(a+this.index+h)),r&&r.classList.add(n)}))},closeDragElement(){if(o.classList.remove("Car_Dragging"),o.parentElement.classList.remove("Car_DraggingParent"),g=0,document.querySelectorAll(".Car_Layout").forEach(t=>{t.classList.remove("Car_PushLeft"),t.classList.remove("Car_PushRight")}),a!==0){let t=this.index+a-this.index;console.log(t);let e={dragLeft:Number(o.style.getPropertyValue("--drag-left")),dragTop:Number(o.style.getPropertyValue("--drag-top"))};this.invertedView?e.dragTop=e.dragTop+l*t*-1:e.dragLeft=e.dragLeft+s*t*-1,this.$emit("newindex",{current:this.index,new:this.index+a,pos:e})}o.style.setProperty("--drag-left",0),o.style.setProperty("--drag-top",0),a=0,u=0,c=0,document.onmouseup=null,document.onmousemove=null},moveCar(t){let e=t.direction==="left"?-1:1,n=t.carIndex+e,r=this.index+e-this.index,i={dragLeft:0,dragTop:0};this.invertedView?i.dragTop=i.dragTop+l*r*-1:i.dragLeft=i.dragLeft+s*r*-1,console.log(i),this.$emit("newindex",{current:t.carIndex,new:n,pos:i})}}};var x=function(){var e=this,n=e._self._c;return e.car!==null?n("div",{staticClass:"Car_Layout",staticStyle:{"--drag-left":"0","--drag-top":"0"},style:{"--drag-left-slo":e.invertedView?7:1,"--drag-top-slo":e.invertedView?1:7},attrs:{id:`Car_Layout${e.index}`},on:{mouseenter:function(r){return e.$emit("enter")}}},[n("BaseCard",{attrs:{car:e.car,"fix-back":!0,downloadLoading:e.downloadLoading,needSave:e.needSave},on:{longTouch:function(r){return e.$emit("longTouch")},dragdown:function(r){return e.dragMouseDown(r)},delete:function(r){return e.$emit("delete")}}}),n("div",{staticClass:"Car_Body"},[n("Row",{attrs:{car:e.car,list:e.trackList,highlights:e.highlights,points:e.points,showPoints:e.showPoints,isReferencePoints:e.isReferencePoints,countPerTrack:e.countPerTrack,hoverIndex:e.hoverIndex,carIndex:e.index,lastIndex:e.lastIndex,maxCarNumber:e.maxCarNumber,loggedin:e.loggedin,user:e.user,voteLoading:e.voteLoading,type:"times"},on:{move:function(r){return e.moveCar(r)},moreTracks:function(r){return e.$emit("moreTracks",r)},delete:function(r){return e.$emit("delete")}}})],1)],1):n("div",{staticClass:"Car_Layout",on:{mouseenter:function(r){return e.$store.commit("HOVER_INDEX",-1)}}},[n("div",{staticClass:"Car_Header Car_AddHeader"},[n("button",{staticClass:"D_Button Car_AddButton add",on:{click:function(r){return e.$emit("add")}}},[n("i",{staticClass:"ticon-plus_2 Car_AddIcon",attrs:{"aria-hidden":"true"}})])])])},L=[],w=C(_,x,L,!1,null,null);const $=w.exports;export{$ as C};
