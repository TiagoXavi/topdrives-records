import{R as B}from"./Row-DOgu6NRG.js";import{n as f,i as p}from"./index-BR-PFC2m.js";var _=0,m=0,u=0,g=0,i=null,o=0,d=0,h=!0,T=0,v=!1;const k={name:"BaseEventTrackbox",components:{Row:B,BaseCheckBox:p},props:{event:{type:Object,default(){return{}}},user:{required:!1},check:{required:!1},eventLoadingAny:{type:Boolean,default:!1},eventForceAnalyze:{type:Boolean,default:!1},showBestPerTrack:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},hideCheckBox:{type:Boolean,default:!1},disableCampaignTip:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},mini:{type:Boolean,default:!1},miniHeight:{type:Boolean,default:!1},size:{type:Number,default:0},eventBestPerTrack:{type:Object,default(){return{}}},index:{}},data(){return{isMobile:!1,itrackset:null,itrackMonoArray:null,deleteTime:!1,deleteTimeIndex:0,runAnimation:!0}},watch:{},beforeMount(){this.isMobile=Vue.options.filters.isMobile()},mounted(){h||(this.runAnimation=!1)},computed:{},methods:{changeRunAnimation(){this.runAnimation=!1,h=!1},dragMouseDown(s,e,t){this.itrackset=e,this.itrackMonoArray=t,i=document.querySelector(`#EventTrack_${this.index}_${e}_${t}`),s=s||window.event,s.preventDefault(),_=s.clientX,m=s.clientY,document.onmouseup=this.closeDragElement,document.onmousemove=this.elementDrag},elementDrag(s){if(u=s.clientX-_,g=s.clientY-m,v=!v,v)return;i.style.setProperty("--drag-left",u),i.style.setProperty("--drag-top",g),i.classList.add("EventTrack_Dragging"),i.parentElement.parentElement.classList.add("EventTrack_DraggingParent"),i.parentElement.parentElement.classList.add("EventTrack_HideButtons"),T=Number(getComputedStyle(i).getPropertyValue("--cg-width").trim().slice(0,-2)),o=Math.round(u/T);let e=Math.abs(o),t=o>0?"EventTrack_PushLeft":"EventTrack_PushRight",c;o!==d&&(d=o,document.querySelectorAll(".EventTrack").forEach(a=>{a.classList.remove("EventTrack_PushLeft"),a.classList.remove("EventTrack_PushRight")}),Array.from(Array(e)).map((a,n)=>{o>0?c=document.querySelector(`#EventTrack_${this.index}_${this.itrackset}_${o+this.itrackMonoArray-n}`):c=document.querySelector(`#EventTrack_${this.index}_${this.itrackset}_${o+this.itrackMonoArray+n}`),c&&c.classList.add(t)}))},closeDragElement(){if(i.classList.remove("EventTrack_Dragging"),i.parentElement.parentElement.classList.remove("EventTrack_DraggingParent"),setTimeout(()=>{i.parentElement.parentElement.classList.remove("EventTrack_HideButtons")},500),d=0,document.querySelectorAll(".EventTrack").forEach(s=>{s.classList.remove("EventTrack_PushLeft"),s.classList.remove("EventTrack_PushRight")}),o!==0){let s=this.itrackMonoArray+o-this.itrackMonoArray;console.log(s),Number(i.style.getPropertyValue("--drag-left")),Number(i.style.getPropertyValue("--drag-top")),this.$emit("newindex",{current:this.itrackMonoArray,new:this.itrackMonoArray+o,itrackset:this.itrackset})}i.style.setProperty("--drag-left",0),i.style.setProperty("--drag-top",0),o=0,document.onmouseup=null,document.onmousemove=null},deleteClick(s){this.deleteTime?(this.deleteTime=!1,this.$emit("delete",{itrackset:s})):(this.deleteTime=!0,this.deleteTimeIndex=s,setTimeout(()=>{this.deleteTime=!1},1e3))}}};var E=function(){var e=this,t=e._self._c;return t("div",{staticClass:"BaseEventTrackbox_Contents",class:{BaseEventTrackbox_Mini:e.mini,BaseEventTrackbox_MiniHeight:e.miniHeight}},e._l(e.event.resolvedTrackset,function(c,a){return t("div",{staticClass:"Cg_Box BaseEventTrackbox_BoxRelative",class:{BaseEventTrackbox_LineInactive:e.check&&e.check[0]!=a},style:e.size?`--cg-width: ${e.size}px;`:""},e._l(c,function(n,l){return t("div",{staticClass:"Cg_Track EventTrack",style:{"--drag-left-slo":1,"--drag-top-slo":7},attrs:{id:`EventTrack_${e.index}_${a}_${l}`}},[l===0&&e.user&&!e.eventForceAnalyze&&!e.hideCheckBox?t("div",{staticClass:"BaseEventTrackbox_ClassCheck"},[t("BaseCheckBox",{attrs:{value:e.check===`${a}_${l}`},on:{change:function(r){e.$emit("openKingFilter",{itrackset:a,itrackMonoArray:l}),e.changeRunAnimation()},click:function(r){e.$emit("openKingFilter",{itrackset:a,itrackMonoArray:l,e:r}),e.changeRunAnimation()}}}),a===0&&e.runAnimation?t("div",{staticClass:"BaseEventTrackbox_CheckAnimation ticon-"},[e._v("check_box_outline_blank")]):e._e()],1):e._e(),l===0&&e.user&&e.eventForceAnalyze?t("div",{staticClass:"BaseEventTrackbox_EditBox"},[t("button",{staticClass:"D_Button Cg_SelectTrackButton",class:{D_ButtonRed:e.deleteTime&&e.deleteTimeIndex===a},on:{click:function(r){return e.deleteClick(a)}}},[t("i",{staticClass:"ticon-close_3 BaseEventTrackbox_EditButtonIcon",attrs:{"aria-hidden":"true"}})]),t("div",{staticClass:"BaseEventTrackbox_UpDownBox"},[t("button",{staticClass:"D_Button Cg_SelectTrackButton",on:{click:function(r){return e.$emit("up",{itrackset:a})}}},[t("i",{staticClass:"ticon-keyboard_arrow_up BaseEventTrackbox_EditButtonIcon",attrs:{"aria-hidden":"true"}})]),t("button",{staticClass:"D_Button Cg_SelectTrackButton",on:{click:function(r){return e.$emit("down",{itrackset:a})}}},[t("i",{staticClass:"ticon-keyboard_arrow_down BaseEventTrackbox_EditButtonIcon",attrs:{"aria-hidden":"true"}})])])]):e._e(),n&&n.length===1?t("Row",{staticClass:"Cg_TrackBox",attrs:{list:n,loggedin:!!e.user,user:e.user,options:e.user&&e.user.mod,cg:!0,showCampaignTip:(!e.showBestPerTrack||!e.eventBestPerTrack[n[0].code||""])&&!e.disableCampaignTip&&!e.compact,showingBestPerTrack:e.showBestPerTrack&&Object.keys(e.eventBestPerTrack).length>0,type:"tracks"}}):e._e(),e.user&&e.user.mod&&!e.readonly?t("button",{staticClass:"D_Button Cg_SelectTrackButton",class:{Cg_SelectTrackButtonEdit:n&&n.length===1},attrs:{disabled:e.eventLoadingAny},on:{click:function(r){return e.$emit("openDialogTrackSearch",{itrackset:a,itrackMonoArray:l})}}},[n&&n.length===1?t("i",{staticClass:"ticon-pencil Cg_SelectTrackButtonIcon",attrs:{"aria-hidden":"true"}}):t("span",[e._v(e._s(e.$t("m_selectTrack")))])]):e._e(),e.isMobile&&!e.readonly&&n&&n.length===1&&l<4?t("button",{staticClass:"D_Button Cg_SelectTrackButton Cg_SelectTrackButtonEdit Cg_SelectTrackButtonMoveRight",attrs:{disabled:e.eventLoadingAny},on:{click:function(r){return e.$emit("eventMoveTrackRight",{itrackset:a,itrackMonoArray:l})}}},[t("i",{staticClass:"ticon-arrow_right_3 Cg_SelectTrackButtonIcon",attrs:{"aria-hidden":"true"}})]):e._e(),!e.isMobile&&!e.readonly&&n&&n.length===1?t("button",{staticClass:"D_Button Cg_SelectTrackButton Cg_SelectTrackButtonEdit Cg_DragButtonIcon",attrs:{disabled:e.eventLoadingAny},on:{mousedown:function(r){return e.dragMouseDown(r,a,l)}}},[t("i",{staticClass:"ticon-expand Cg_SelectTrackButtonIcon",staticStyle:{transform:"rotate(45deg)"},attrs:{"aria-hidden":"true"}})]):e._e(),e.showBestPerTrack&&Array.isArray(n)&&n[0]&&e.eventBestPerTrack[n[0].code||""]?t("div",{staticClass:"BaseEventTrackbox_BestBox",style:`--cor: ${e.eventBestPerTrack[n[0].code].color}`},[t("div",{staticClass:"BaseEventTrackbox_BestPhoto"},[t("img",{staticClass:"BaseEventTrackbox_BestImg",attrs:{src:e.eventBestPerTrack[n[0].code].photo,alt:""}}),t("div",{staticClass:"BaseEventTrackbox_BestTune",class:`BaseEventTrackbox_BestTune${e.eventBestPerTrack[n[0].code].tune}`},[e._v(e._s(e.eventBestPerTrack[n[0].code].tune))])])]):e._e()],1)}),0)}),0)},C=[],b=f(k,E,C,!1,null,null);const $=b.exports;export{$ as B};
